{"componentChunkName":"component---src-templates-post-js","path":"/dynamic-pwa-manifest-using-javascript-and-rest-api","result":{"data":{"site":{"siteMetadata":{"title":"Rajat Hans","description":"This is where I post stuff about indie hacking and tech entrepreneurship!","author":{"name":"rajathans"},"keywords":["Video Blogger"]}},"mdx":{"frontmatter":{"title":"Turning a static PWA React application into custom native apps for customers","date":"September 20, 2019","author":null,"banner":null,"slug":"dynamic-pwa-manifest-using-javascript-and-rest-api","keywords":null},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"slug\": \"dynamic-pwa-manifest-using-javascript-and-rest-api\",\n  \"date\": \"2019-09-20T00:00:00.000Z\",\n  \"title\": \"Turning a static PWA React application into custom native apps for customers\",\n  \"description\": \"Read about how I turned a React PWA application to have customer specific customizations using dynamic manifests\",\n  \"published\": true,\n  \"banner\": \"\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"All businesses  registered on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://getstudioyou.com\"\n  }), \"StudioYou\"), \" get their own webstore domain (eg. fitnessfirst.getstudioyou.com) where their customers can book classes, personal training, and buy memberships and packs. \"), mdx(\"p\", null, \"We developed the webstore in React. For people who used it in mobile devices we wanted to take it a step further and give them a native app like experience. During my research, I came accross the word PWA (Progressive Web Apps). PWA is basically, as defined by Ionic,\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"A new way to offer incredible mobile app experiences that are highly optimized, reliable, and accessible completely on the web.\")), mdx(\"p\", null, \"They are websites that feel like apps you would find in an App Store but can be installed directly by visiting a webstite instead.\"), mdx(\"p\", null, \"For mobile app and PWA I had a few things in mind:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"native app like experience when opened on mobile\"), \" - Can be done using apt UI/UX\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"different apps for different clients\"), \" - Each client should have their own PWA or app. This way we can give custom apps to our clients.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"push notifications support\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"should work offline\"), \" - Not required for our use case\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"disable pull to refresh and text selection\"), \"  - Apps don't usually have this unlike mobile responsive websites\")), mdx(\"p\", null, \"Building a PWA is pretty straight forward if you are using React, as most of the work is already done. To work offline, your app needs a service worker. It\\u2019s already there if you\\u2019re using \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://facebook.github.io/create-react-app/docs/making-a-progressive-web-app\"\n  }), \"Create React App\"), \", or you can build your own with \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.pwabuilder.com/\"\n  }), \"PWA Builder\"), \".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"{\\n  \\\"short_name\\\": \\\"StudioYou\\\",\\n  \\\"name\\\": \\\"StudioYou App\\\",\\n  \\\"icons\\\": [\\n    {\\n      \\\"src\\\": \\\"/images/icons-192.png\\\",\\n      \\\"type\\\": \\\"image/png\\\",\\n      \\\"sizes\\\": \\\"192x192\\\"\\n    },\\n    {\\n      \\\"src\\\": \\\"/images/icons-512.png\\\",\\n      \\\"type\\\": \\\"image/png\\\",\\n      \\\"sizes\\\": \\\"512x512\\\"\\n    }\\n  ],\\n  \\\"start_url\\\": \\\"\\\",\\n  \\\"background_color\\\": \\\"#3367D6\\\",\\n  \\\"display\\\": \\\"standalone\\\",\\n  \\\"theme_color\\\": \\\"#3367D6\\\",\\n  \\\"orientation\\\": \\\"portrait\\\"\\n}\\n\")), mdx(\"h3\", null, \"The problem\"), mdx(\"p\", null, \"Now, this is enough to build a PWA. But my use case was different, I needed different PWAs at different urls so that they render slightly different with custom colors and icons. In short, \"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"I needed dynamic manifest file instead of a single static manifest file which was present in the React code.\")), mdx(\"h3\", null, \"The solution\"), mdx(\"p\", null, \"So I found that the solution to this problem was to fetch the manifest from and API, which would change the values based on the subdomain.\"), mdx(\"p\", null, \"For example, the website served at fitnessfirst.getstudioyou.com will call an API with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fitnessfirst\"), \" in request body so that I get the appropriate JSON response and use that as manifest.\"), mdx(\"p\", null, \"But since, manifest.json is imported in the main index.html like\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-html\"\n  }), \"<link rel=\\\"manifest\\\" href=\\\"/manifest.json\\\" >\\n\")), mdx(\"p\", null, \"I would need to write some logic in that html file to fetch the subdomain and call the API.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-html\"\n  }), \"<script>\\n    var full = window.location.host; // subdomain.domain.com\\n    var parts = full.split('.');\\n    var sub = parts[0];\\n\\n    link = document.createElement('link');\\n    link.href = 'https://src.getstudioyou.com/api/webstore/manifest/' + sub;\\n    link.rel = 'manifest';\\n\\n    document.getElementsByTagName('head')[0].appendChild(link);\\n</script>\\n<link rel=\\\"manifest\\\" href=\\\"/manifest.json\\\" >\\n\")), mdx(\"p\", null, \"And now the correct manifest will be used based on the domain name in the URL.\"), mdx(\"p\", null, \"The icons in the manifest need to have the same base url as that of the manifest. So you can change the URI of icons to something like\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/api/webstore/manifest/{subdomain or some other unique attribute}/icons/44x44.png\"), \" in the manifest. Now when the manifest is fetched, the icons will be fetched from this URL, so I can change the icons to my client's logo.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"References:\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://developers.google.com/web/fundamentals/web-app-manifest/\"\n  }), \"https://developers.google.com/web/fundamentals/web-app-manifest/\"), \"\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://dev.to/uyouthe/pwa-checklist-2019-25j4\"\n  }), \"https://dev.to/uyouthe/pwa-checklist-2019-25j4\")));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"136de57f-1d9a-52e3-9df7-7cca5e8211e6","prev":{"id":"86744f4a-9eb2-55c8-89be-5fb5717128f1","parent":{"name":"index","sourceInstanceName":"blog"},"excerpt":"To create is to live twice. - Albert Camus Create. Not for the money. Not for the fame. Not for the recognition. But for the pure joy of creating something and sharing it.","fields":{"title":"Indie Hacker: The beginning","slug":"indie-hacker-the-beginning","date":"2019-11-06T00:00:00.000Z"}},"next":null}}}